<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Apply a saga_cmd tool over over a list of raster datasets and mosaick the
results — map_raster • Rsagacmd</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Apply a saga_cmd tool over over a list of raster datasets and mosaick the
results — map_raster" />
<meta property="og:description" content="A `purrr::map` style function to iterate over a list of raster datasets and
apply a saga_cmd tool to each raster. The output grids are automatically
mosaicked into a new raster dataset. The `map_raster` function is can help
with conveniently applying terrain analysis functions to lists of rasters.
One potential application is using tiling to deal with raster datasets that
are too large to fit into memory, and when the
`saga_gis(grid_caching = TRUE)` option is too slow. The tiles can potentially
generated using the `Rsagacmd::tile_geoprocessor` tool, or other functions
that split a dataset.
pck" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rsagacmd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Apply a saga_cmd tool over over a list of raster datasets and mosaick the
results</h1>
    
    <div class="hidden name"><code>map_raster.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A `purrr::map` style function to iterate over a list of raster datasets and
apply a saga_cmd tool to each raster. The output grids are automatically
mosaicked into a new raster dataset. The `map_raster` function is can help
with conveniently applying terrain analysis functions to lists of rasters.
One potential application is using tiling to deal with raster datasets that
are too large to fit into memory, and when the
`saga_gis(grid_caching = TRUE)` option is too slow. The tiles can potentially
generated using the `Rsagacmd::tile_geoprocessor` tool, or other functions
that split a dataset.
pck</p>
    </div>

    <pre class="usage"><span class='fu'>map_raster</span>(<span class='no'>.x</span>, <span class='no'>.f</span>, <span class='kw'>filename</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>options</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>nodata</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>.x</th>
      <td><p>A list.</p></td>
    </tr>
    <tr>
      <th>.f</th>
      <td><p>A saga_cmd function that was generated by `Rsagacmd::saga_gis()` to
apply to each raster dataset in `.x`. The function can be used as it, such
as `saga$ta_morphometry$terrain_ruggedness_index` or can be wrapped inside
another as a partial function to set arguments to the tool or select
specific tool outputs.</p></td>
    </tr>
    <tr>
      <th>filename</th>
      <td><p>A character to optionally specify the path to save the final
mosaicked result. If `filename = NULL` then `tempdir()` is used.</p></td>
    </tr>
    <tr>
      <th>options</th>
      <td><p>A character vector of GDAL creation options used when saving
the dataset, such as `options = c("COMPRESS=DEFLATE", "BIGTIFF=YES")`.</p></td>
    </tr>
    <tr>
      <th>nodata</th>
      <td><p>Any number to use as the nodata value for the output raster. If
`nodata = NULL` then the nodata value will be based on the input raster's
nodata values.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Either a `raster::RasterLayer` or `terra::SpatRaster` object.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>Rsagacmd</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>terra</span>)

<span class='no'>saga</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='saga_gis.html'>saga_gis</a></span>(<span class='kw'>backend</span> <span class='kw'>=</span> <span class='st'>"terra"</span>)

<span class='co'># generate a dem and split into tiles</span>
<span class='no'>dem</span> <span class='kw'>&lt;-</span> <span class='no'>saga</span>$<span class='no'>grid_calculus</span>$<span class='fu'>random_terrain</span>()
<span class='no'>dem_tiles</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='tile_geoprocessor.html'>tile_geoprocessor</a></span>(<span class='no'>saga</span>, <span class='no'>dem</span>, <span class='kw'>nx</span> <span class='kw'>=</span> <span class='fl'>25</span>, <span class='kw'>ny</span> <span class='kw'>=</span> <span class='fl'>25</span>)

<span class='co'># apply a saga tool function to each tile</span>
<span class='no'>tile_output</span> <span class='kw'>&lt;-</span> <span class='fu'>map_raster</span>(
    <span class='no'>dem_tiles</span>,
    <span class='no'>saga</span>$<span class='no'>ta_morphometry</span>$<span class='no'>terrain_ruggedness_index</span>
)

<span class='co'># alternatively use a partial function to set arguments to the tool</span>
<span class='no'>tri_func</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>dem</span>) {
    <span class='no'>saga</span>$<span class='no'>ta_morphometry</span>$<span class='fu'>terrain_ruggedness_index</span>(
        <span class='kw'>dem</span> <span class='kw'>=</span> <span class='no'>dem</span>,
        <span class='kw'>radius</span> <span class='kw'>=</span> <span class='fl'>7</span>
     )
}

<span class='no'>tile_output</span> <span class='kw'>&lt;-</span> <span class='fu'>map_raster</span>(<span class='no'>dem_tiles</span>, <span class='no'>tri_func</span>)

<span class='co'># if the saga tool produces multiple outputs then each output will be</span>
<span class='co'># mosaicked automatically and returned as a list of raster datasets</span>
<span class='no'>tile_output</span> <span class='kw'>&lt;-</span> <span class='fu'>map_raster</span>(
    <span class='no'>dem_tiles</span>,
    <span class='no'>saga</span>$<span class='no'>ta_hydrology</span>$<span class='no'>saga_wetness_index</span>
)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steven Pawley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


